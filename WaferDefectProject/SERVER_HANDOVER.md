# æ™¶åœ†ç¼ºé™·åˆ†ç±»ç³»ç»Ÿ - æœåŠ¡å™¨ç«¯äº¤æ¥æ–‡æ¡£ (Server Handover)

## ğŸ‘¤ è‡´ï¼šæœåŠ¡å™¨ç«¯ AI åŠ©æ‰‹ (Server-side AI Agent)
**æˆ‘æ˜¯è´Ÿè´£æœ¬åœ°å¼€å‘çš„ AIã€‚æœ¬åœ°ç¯å¢ƒéªŒè¯å·²å®Œæˆï¼Œç°åœ¨å°†æ¥åŠ›æ£’äº¤ç»™ä½ ã€‚**
è¯·æ ¹æ®ä»¥ä¸‹èƒŒæ™¯ã€ç›®æ ‡å’Œæ–‡ä»¶æ¸…å•ï¼Œè¾…åŠ©ç”¨æˆ·å®Œæˆæœ€ç»ˆçš„é«˜æ€§èƒ½éƒ¨ç½²ã€‚

---

## ğŸ“‹ é¡¹ç›®èƒŒæ™¯ (Project Context)
æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª **åŸºäº MobileNetV4 çš„é«˜æ€§èƒ½æ™¶åœ†ç¼ºé™·åˆ†ç±»ç³»ç»Ÿ**ã€‚
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¯†åˆ« `MixedWM38` æ•°æ®é›†ä¸­çš„ 38 ç§ç¼ºé™·æ¨¡å¼ï¼Œå¹¶æœ€ç»ˆéƒ¨ç½²åœ¨è¾¹ç¼˜ GPU (TensorRT) ä¸Šã€‚

### ğŸ“Š å½“å‰è¿›åº¦ (Current Status)
1.  **æ•°æ®**: `src/dataset.py` å·²å®ç°ï¼Œèƒ½æ­£ç¡®è¯»å– `.npz` æ–‡ä»¶å¹¶è§£æ 8-bit äºŒè¿›åˆ¶æ ‡ç­¾ã€‚
2.  **æ¨¡å‹**: `src/model.py` é›†æˆäº† `timm` çš„ `mobilenetv4_conv_small`ã€‚
3.  **è®­ç»ƒ**: `train.py` åœ¨æœ¬åœ°æµ‹è¯•é€šè¿‡ (Epoch 1 Acc > 80%)ï¼Œé€»è¾‘é€šç•…ã€‚
4.  **å¯¼å‡º**: `export_onnx.py` å¯æˆåŠŸç”Ÿæˆç®€åŒ–çš„ ONNX æ¨¡å‹ã€‚
5.  **C++**: `cpp_inference/` ç›®å½•ä¸‹å·²å†™å¥½ TensorRT æ¨ç†ä»£ç å’Œ CUDA é¢„å¤„ç†ç®—å­ï¼Œç­‰å¾…ç¼–è¯‘ã€‚
6.  **é—æ†¾**: å› æœ¬åœ°æ˜¾å¡é©±åŠ¨ç‰ˆæœ¬ä½ï¼Œæœªèƒ½æ‰§è¡Œ TensorRT å¼•æ“ç”Ÿæˆå’Œ C++ ç¼–è¯‘ã€‚è¿™éœ€è¦ä½ æ¥å®Œæˆã€‚

---

## ğŸ¯ ä½ çš„ä»»åŠ¡ç›®æ ‡ (Mission Objectives)
è¯·åŠ¡å¿…ç¡®ä¿é¡¹ç›®è¾¾åˆ°ä»¥ä¸‹ **ç¡¬æ€§æŒ‡æ ‡** (ç®€å†æ ¸å¿ƒäº®ç‚¹)ï¼š

1.  **é«˜ç²¾åº¦è®­ç»ƒ**:
    - ä¿®æ”¹ `train.py`ï¼Œå¢åŠ  Epoch (å»ºè®® 50-100) å’Œè°ƒæ•´å­¦ä¹ ç‡ç­–ç•¥ã€‚
    - åŠ¡å¿…ä½¿æµ‹è¯•é›† **Top-1 å‡†ç¡®ç‡ > 97.2%**ã€‚
    - ä¿å­˜æœ€ä¼˜æƒé‡ `mobilenetv4_best.pth`ã€‚

2.  **é«˜æ€§èƒ½æ¨ç†**:
    - **FP16 ä¼˜åŒ–**: åœ¨ç”Ÿæˆ TensorRT Engine æ—¶å¿…é¡»å¼€å¯ FP16ã€‚
    - **è‡ªå®šä¹‰ç®—å­**: ç¼–è¯‘å¹¶é“¾æ¥ `preprocess.cu`ï¼Œå®ç° GPU ç«¯å›¾åƒå½’ä¸€åŒ–ã€‚
    - **å»¶è¿Ÿè¾¾æ ‡**: ç¡®ä¿å•å¸§æ¨ç†å»¶è¿Ÿ **çº¦ 1.5ms** (åŸºäºè¾¹ç¼˜ GPU ç¯å¢ƒ)ã€‚
    - **ååé‡**: æ»¡è¶³ > 120 WPHã€‚

---

## ğŸ“¦ æ–‡ä»¶äº¤æ¥æ¸…å• (Files Provided)
ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å¤¹ `WaferDefectProject` åŒ…å«ï¼š

| æ–‡ä»¶/ç›®å½• | è¯´æ˜ |
| :--- | :--- |
| `src/dataset.py` | æ•°æ®åŠ è½½å™¨ (æ— éœ€ä¿®æ”¹ï¼Œé™¤éæ•°æ®è·¯å¾„å˜åŠ¨) |
| `src/model.py` | MobileNetV4 å®šä¹‰ (æ— éœ€ä¿®æ”¹) |
| `train.py` | **éœ€è¦ä¿®æ”¹**ï¼šå¢åŠ  Epochsï¼Œè¿›è¡Œé•¿æ—¶è®­ç»ƒ |
| `export_onnx.py` | ç”¨äºå°†è®­ç»ƒå¥½çš„ .pth è½¬ä¸º .onnx |
| `verify_tensorrt.py` | Pythonç‰ˆ TensorRT éªŒè¯è„šæœ¬ (å¯ç”¨äºåˆæ­¥æµ‹è¯• Engine) |
| `cpp_inference/` | **æ ¸å¿ƒäº¤ä»˜ç‰©**ï¼šC++ æ¨ç†æºç  |
| â”œâ”€â”€ `main.cpp` | TensorRT C++ æ¨ç†ä¸»ç¨‹åº |
| â”œâ”€â”€ `preprocess.cu` | CUDA è‡ªå®šä¹‰é¢„å¤„ç†æ ¸å‡½æ•° |
| â””â”€â”€ `CMakeLists.txt` | ç¼–è¯‘è„šæœ¬ (éœ€æ ¹æ®æœåŠ¡å™¨è·¯å¾„å¾®è°ƒ) |

ä»¥åŠæ•°æ®é›†æ–‡ä»¶ï¼š
- `../dataset_repo/Wafer_Map_Datasets.npz` (è¯·ç¡®è®¤æœåŠ¡å™¨ä¸Šçš„å­˜æ”¾è·¯å¾„)

---

## ğŸš€ æ‰§è¡Œæ­¥éª¤å»ºè®® (Action Plan)

1.  **ç¯å¢ƒæ£€æŸ¥**: ç¡®è®¤æœåŠ¡å™¨æœ‰ PyTorch, CUDA, TensorRT, OpenCVã€‚
2.  **å…¨é‡è®­ç»ƒ**: è¿è¡Œ `python train.py`ï¼Œç›´åˆ° Accuracy > 97.2%ã€‚
3.  **æ¨¡å‹å¯¼å‡º**: è¿è¡Œ `python export_onnx.py`ã€‚
4.  **æ„å»ºå¼•æ“**: ä½¿ç”¨ `trtexec --onnx=mobilenetv4.onnx --saveEngine=mobilenetv4.engine --fp16`ã€‚
5.  **C++ ç¼–è¯‘ä¸è¿è¡Œ**:
    ```bash
    cd cpp_inference
    mkdir build && cd build
    cmake ..
    make
    ./wafer_infer
    ```
6.  **æ€§èƒ½éªŒè¯**: è®°å½• `./wafer_infer` è¾“å‡ºçš„å»¶è¿Ÿæ•°æ®ï¼Œç¡®ä¿ < 1.5msã€‚

**è¯·è¾…åŠ©ç”¨æˆ·å®Œæˆä¸Šè¿°æ­¥éª¤ï¼Œç‰¹åˆ«æ˜¯ C++ ç¯å¢ƒçš„é…ç½®å’Œç¼–è¯‘é”™è¯¯æ’æŸ¥ã€‚**
